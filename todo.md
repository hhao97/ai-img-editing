# 电商AI商品图生成器 - 项目 TODO

## 核心功能
- [ ] API Key 管理 - 用户输入并保存 OpenRouter API Key 到本地存储
- [x] 图片生成功能 - 集成 OpenRouter nanobanana 模型的文字生成图片
- [x] 图片改写功能 - 上传原图并通过 AI 修改
- [x] 图片上传功能 - 支持相机和相册选择，上传到 S3
- [x] 生成历史记录 - 数据库存储和展示用户历史

## 数据库和后端
- [x] 数据库 schema 设计 - 存储图片记录、prompt、参数
- [x] 图片生成 API 接口 - tRPC 后端实现
- [x] 图片改写 API 接口 - tRPC 后端实现
- [x] 历史记录查询接口 - tRPC 后端实现
- [x] 单元测试 - 核心功能的 vitest 测试
## 前端 UI/UX
- [x] 全局样式设置 - 斯堪的纳维亚美学风格（浅冷灰、粥蓝、腦红粥）
- [x] 主页布局 - 移动端优先的响应式设计
- [x] API Key 设置页面 - 输入和保存 API Key
- [x] 图片生成页面 - 文字输入、生成、加载状态
- [x] 图片改写页面 - 图片上传、修改要求输入、生成
- [x] 历史记录页面 - 展示生成历史，支持查看详情
- [x] 加载状态和进度提示 - 友好的等待界面
- [x] 错误处理和提示 - API Key 验证、生成失败等场景
## 移动端适配
- [x] H5 响应式设计 - 完全适配手机屏幕
- [x] 触摸交互优化 - 按预大小、点击区域
- [x] 图片上传交互 - 相机和相册选择
- [x] 滑动和性能 - 列表滑动流畅，图片加载优化

## 部署和交付
- [x] 环境变量配置 - OpenRouter API 相关配置
- [x] 代码检查和测试 - 运行 pnpm test
- [ ] 项目检查点 - 保存第一个完整版本
- [x] 用户文档 - 使用说明和功能介绍

## Bug 修复
- [x] 修复 OpenRouter 模型配置 - 更新为 google/gemini-2.5-flash-image-preview
- [x] 更新 API Key 验证逻辑 - 确保与 Gemini 2.5 Flash 兼容
- [x] 测试图片生成功能 - 验证新模型配置正常工作

## API 响应处理修复
- [x] 修复 API 响应解析 - 从 choices[0].message.images[0].image_url.url 提取 base64 数据
- [x] 处理 base64 图片 - 将 base64 转换为可用的图片 URL 或上传到 S3
- [x] 更新前端显示 - 正确显示生成的图片

## 当前修复
- [x] 修复 API Key 验证逻辑 - 改进 validateApiKey 函数的实现
- [x] 优化错误处理 - 提供更清晰的错误信息给前端
- [x] 测试 API Key 验证 - 确保验证流程正确

## 首页 UI 重新设计
- [x] 更新全局样式 - 改为深色系主题（深灰/黑色背景）
- [x] 重新设计首页 - 支持免登录访问，展示功能和示例
- [x] 添加分类标签 - 热门、产品宣传、多图融合、换背景等
- [x] 添加模板预览 - 展示生成效果示例的图片网格
- [x] 添加尺寸选择 - 支持 1:1、4:3、3:4、16:9、9:16 等比例
- [x] 优化文本输入区域 - 大型输入框用于描述或选择模板
- [x] 添加登录入口 - 在需要时提示用户登录
- [x] 测试首页功能 - 确保免登录访问和所有交互正常
